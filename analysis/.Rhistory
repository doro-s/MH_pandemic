install.packages('tidyverse')
library(tidyverse)
library(tidyverse)
read_csv('D:MH_pandemic\output\input_cis_vl.csv')
library(tidyverse)
read_csv('D:\\MH_pandemic\\output\\input_cis_vl.csv')
library(tidyverse)
cis_wide <- read_csv('D:\\MH_pandemic\\output\\input_cis_vl.csv')
View(cis_wide)
str(cis_wide)
colnames(cis_wide)
cis_long <- cis_wide %>%
select(patient_id, matches('cis\\_visit\\_date\\d+'))
View(cis_long)
cis_long <- cis_wide %>%
select(patient_id, matches('cis\\_visit\\_date\\_\\d+'))
View(cis_long)
cis_long <- cis_wide %>%
select(patient_id, matches('cis\\_visit\\_date\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'cis_visit_date'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'visit_date',
values_drop_na = TRUE) %>%
arrange(patient_id, date)
cis_long <- cis_wide %>%
select(patient_id, matches('cis\\_visit\\_date\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'cis_visit_date'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'visit_date',
values_drop_na = TRUE)
View(cis_long)
cis_long <- cis_wide %>%
select(patient_id, matches('cis\\_visit\\_date\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'cis_visit_date'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'visit_date',
values_drop_na = TRUE) %>%
arrange(patient_id, visit_date)
library(tidyverse)
cis_wide <- read_csv('D:\\MH_pandemic\\output\\input_cis_vl.csv')
cis_long <- cis_wide %>%
select(patient_id, matches('cis\\_visit\\_date\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'visit_number'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'visit_date',
values_drop_na = TRUE) %>%
arrange(patient_id, visit_number)
View(cis_long)
library(tidyverse)
cis_wide <- read_csv('D:\\MH_pandemic\\output\\input_cis_vl.csv')
cis_long <- cis_wide %>%
select(patient_id, matches('cis\\_visit\\_date\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'visit_number'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'visit_date',
values_drop_na = TRUE) %>%
arrange(patient_id, visit_number)
write_csv(cis_long, 'D:\\MH_pandemic\\output\\cis_long.csv')
library(tidyverse)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
cis_wide <- rea
library(tidyverse)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
cis_wide <- read_csv('../output/input_cis_wide.csv')
View(cis_wide)
library(tidyverse)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
cis_wide <- read_csv('../output/input_cis_wide.csv')
visit_date <- cis_wide %>%
select(patient_id, matches('visit\\_date\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'visit_number'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'visit_date',
values_drop_na = TRUE) %>%
mutate(visit_number = as.numeric(visit_number)) %>%
arrange(patient_id, visit_number)
result_mk <- cis_wide %>%
select(patient_id, matches('resul\\mk\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'visit_number'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'visit_date',
values_drop_na = TRUE) %>%
mutate(visit_number = as.numeric(visit_number)) %>%
arrange(patient_id, visit_number)
result_mk <- cis_wide %>%
select(patient_id, matches('result\\mk\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'visit_number'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'visit_date',
values_drop_na = TRUE) %>%
mutate(visit_number = as.numeric(visit_number)) %>%
arrange(patient_id, visit_number)
result_mk <- cis_wide %>%
select(patient_id, matches('result\\_mk\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'visit_number'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'visit_date',
values_drop_na = TRUE) %>%
mutate(visit_number = as.numeric(visit_number)) %>%
arrange(patient_id, visit_number)
View(result_mk)
cis_long <- visit_date %>%
left_join(result_mk, by = c('patient_id', 'visit_number'))
View(cis_long)
View(result_mk)
library(tidyverse)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
cis_wide <- read_csv('../output/input_cis_wide.csv')
visit_date <- cis_wide %>%
select(patient_id, matches('visit\\_date\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'visit_number'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'visit_date',
values_drop_na = TRUE) %>%
mutate(visit_number = as.numeric(visit_number)) %>%
arrange(patient_id, visit_number)
result_mk <- cis_wide %>%
select(patient_id, matches('result\\_mk\\_\\d+')) %>%
pivot_longer(cols = -patient_id,
names_to = c(NA, 'visit_number'),
names_pattern = '^(.*)_(\\d+)',
values_to = 'result_mk',
values_drop_na = TRUE) %>%
mutate(visit_number = as.numeric(visit_number)) %>%
arrange(patient_id, visit_number)
cis_long <- visit_date %>%
left_join(result_mk, by = c('patient_id', 'visit_number'))
View(cis_long)
View(cis_long)
